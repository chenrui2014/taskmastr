function windowWidth(){return $(window).width()}function windowHeight(){return $(window).height()}function loadData(e){$.ajax({url:"users/login",method:"POST",data:{key:e},dataType:"json",success:function(e){userObj=e,e.todos.forEach(function(e,t){var o=e.item,s=e.status,a=s?"fa fa-check-circle-o":"fa fa-circle-o",i=s?"checked":"";$("#todo-list").append('<li class="todo '+s+'" value="'+o+'"><input type="checkbox" class="check" '+i+'></input><i class="'+a+'"></i><input type="text" class="rename" style="display: none;" value="'+o+'"></input><span class="name">'+o+'</span><i class="fa fa-trash-o"></i></li>')}),$("#dark-mode").attr("value",e.darkmode),"on"===e.darkmode&&($("#dark-mode").addClass("dark"),$("body").addClass("dark-mode"))},error:function(e){console.log(e)}})}function keyModal(){function e(){s.fadeOut(500),o.removeClass("active-modal").animate({top:"-1000px"},500)}{var t=windowWidth(),o=(windowHeight(),$("#key-modal")),s=$("#mask"),a=o.width();o.height()}o.addClass("active-modal").css({left:t/2-a/2-10+"px"}),o.animate({top:"10%"},500),windowWidth()<768&&o.css({width:t+"px"}),function(){$("#tips-button").click(function(){$(".fine-print").slideToggle(250)})}(),$("#key").focus(),s.click(function(){e(),$("#create-todo").focus()}),$("#key").keydown(function(){var t=event.which;13===t&&(userKey=$(this).val(),e(),userKey&&loadData(userKey),$("#create-todo").focus())})}function sortable(){var e=$("#todo-list");e.sortable({axis:"y",items:"> li:not(.complete)"})}function createTodo(){$("#create-todo").keydown(function(){var e=event.which;if(13===e){var t=$(this).val();$("#todo-list").prepend('<li class="todo" value="'+t+'"><input type="checkbox" class="check"></input><i class="fa fa-circle-o"></i><input type="text" class="rename" style="display: none;" value="'+t+'"></input><span class="name">'+t+'</span><i class="fa fa-trash-o"></i></li>'),$(this).val("")}})}function completeItem(){$("#todo-list").on("click",".fa-circle-o",function(){$(this).siblings(".check").click(),$(this).removeClass("fa-circle-o").addClass("fa-check-circle-o")}),$("#todo-list").on("click",".fa-check-circle-o",function(){$(this).siblings(".check").click(),$(this).removeClass("fa-check-circle-o").addClass("fa-circle-o")}),$("#todo-list").on("click",".check",function(){var e=$(this).prop("checked"),t=$(this).parent(),o=$(this).parents("#todo-list"),s=$(this).parent().siblings(".complete").first();e?(t.addClass("complete"),s.length>0?s.before(t):o.append(t),o.sortable("destroy"),sortable()):(t.removeClass("complete"),s.length>0?s.before(t):o.append(t),o.sortable("destroy"),sortable())})}function deleteItem(){$("#todo-list").on("click",".fa-trash-o",function(){$(this).parents("li").toggle("slide",500,function(){$(this).remove()})})}function renameItem(){$("#todo-list").on("dblclick",".name",function(){$(this).text();$(this).hide(),$(this).siblings(".rename").show().select()}),$("#todo-list").on("keydown",".rename",function(){var e=event.which;if(13===e){var t=$(this).val();$(this).siblings(".name").show().text(t),$(this).hide().attr("value",t),$(this).parents(".todo").attr("value",t)}})}function writeData(){function e(){var e=$("#todo-list li"),t=[],o=new Date;return e.each(function(e,o){var s=$(this).attr("value"),a={};a.item=s,a.status=$(this).hasClass("complete")?"complete":"",t.push(a)}),userObj.todos=t,userObj.darkmode=$("#dark-mode").attr("value"),userObj.dateModified=o.toISOString(),userObj}window.addEventListener("beforeunload",function(t){var o=userKey.length>0?e():null;userKey&&$.post("/users/write",{json:JSON.stringify(o)},function(e){console.log(e)})}),window.addEventListener("pagehide",function(t){var o=userKey.length>0?e():null;userKey&&$.post("/users/write",{json:JSON.stringify(o)},function(e){console.log(e)})})}function darkMode(){$("#dark-mode").click(function(){$(this).toggleClass("dark"),$("body").toggleClass("dark-mode");var e=$(this).hasClass("dark")?"on":"off";$(this).attr("value",e)})}var userKey,userObj;$(keyModal),$(sortable),$(createTodo),$(completeItem),$(deleteItem),$(renameItem),$(writeData),$(darkMode);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvcmtpbmctZmlsZS5qcyJdLCJuYW1lcyI6WyJ3aW5kb3dXaWR0aCIsIiQiLCJ3aW5kb3ciLCJ3aWR0aCIsIndpbmRvd0hlaWdodCIsImhlaWdodCIsImxvYWREYXRhIiwia2V5IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJ1c2VyIiwidXNlck9iaiIsInRvZG9zIiwiZm9yRWFjaCIsInZhbCIsImkiLCJ0b2RvIiwiaXRlbSIsImNvbXBsZXRlIiwic3RhdHVzIiwiaWNvbiIsImNoZWNrZWQiLCJhcHBlbmQiLCJhdHRyIiwiZGFya21vZGUiLCJhZGRDbGFzcyIsImVycm9yIiwicmVzdWx0IiwiY29uc29sZSIsImxvZyIsImtleU1vZGFsIiwicmVtb3ZlTW9kYWwiLCJtYXNrIiwiZmFkZU91dCIsIm1vZGFsIiwicmVtb3ZlQ2xhc3MiLCJhbmltYXRlIiwidG9wIiwibW9kYWxXaWR0aCIsImNzcyIsImxlZnQiLCJjbGljayIsInNsaWRlVG9nZ2xlIiwiZm9jdXMiLCJrZXlkb3duIiwiZXZlbnQiLCJ3aGljaCIsInVzZXJLZXkiLCJ0aGlzIiwic29ydGFibGUiLCJsaXN0IiwiYXhpcyIsIml0ZW1zIiwiY3JlYXRlVG9kbyIsInByZXBlbmQiLCJjb21wbGV0ZUl0ZW0iLCJvbiIsInNpYmxpbmdzIiwicHJvcCIsInBhcmVudCIsInBhcmVudHMiLCJmaXJzdENvbXBsZXRlIiwiZmlyc3QiLCJsZW5ndGgiLCJiZWZvcmUiLCJkZWxldGVJdGVtIiwidG9nZ2xlIiwicmVtb3ZlIiwicmVuYW1lSXRlbSIsInRleHQiLCJoaWRlIiwic2hvdyIsInNlbGVjdCIsIm5ld05hbWUiLCJ3cml0ZURhdGEiLCJjcmVhdGVPYmoiLCJsaUFyciIsInRvZG9BcnIiLCJub3ciLCJEYXRlIiwiZWFjaCIsInRvZG9UZXh0IiwidG9kb09iaiIsImhhc0NsYXNzIiwicHVzaCIsImRhdGVNb2RpZmllZCIsInRvSVNPU3RyaW5nIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJvYmoiLCJwb3N0IiwianNvbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJkYXJrTW9kZSIsInRvZ2dsZUNsYXNzIiwidmFsdWUiXSwibWFwcGluZ3MiOiJBQUdBLFFBQVNBLGVBQ1IsTUFBT0MsR0FBRUMsUUFBUUMsUUFHbEIsUUFBU0MsZ0JBQ1IsTUFBT0gsR0FBRUMsUUFBUUcsU0FHbEIsUUFBU0MsVUFBU0MsR0FDakJOLEVBQUVPLE1BQ0RDLElBQUssY0FDTEMsT0FBUSxPQUNSQyxNQUNDSixJQUFLQSxHQUVOSyxTQUFVLE9BQ1ZDLFFBQVMsU0FBVUMsR0FDbEJDLFFBQVVELEVBQ1ZBLEVBQUtFLE1BQU1DLFFBQVEsU0FBVUMsRUFBS0MsR0FDakMsR0FBSUMsR0FBT0YsRUFBSUcsS0FDWEMsRUFBV0osRUFBSUssT0FDZkMsRUFBT0YsRUFBVyx1QkFBeUIsaUJBQzNDRyxFQUFVSCxFQUFXLFVBQVksRUFDckNyQixHQUFFLGNBQWN5QixPQUNmLG1CQUFxQkosRUFBVyxZQUFjRixFQUFPLDBDQUE0Q0ssRUFBVSxzQkFBd0JELEVBQU8seUVBQTJFSixFQUFPLGdDQUFrQ0EsRUFBTywrQ0FHdlFuQixFQUFFLGNBQWMwQixLQUFLLFFBQVNiLEVBQUtjLFVBQ2IsT0FBbEJkLEVBQUtjLFdBQ1IzQixFQUFFLGNBQWM0QixTQUFTLFFBQ3pCNUIsRUFBRSxRQUFRNEIsU0FBUyxlQUdyQkMsTUFBTyxTQUFVQyxHQUNoQkMsUUFBUUMsSUFBSUYsTUFNZixRQUFTRyxZQVFSLFFBQVNDLEtBQ1JDLEVBQUtDLFFBQVEsS0FDYkMsRUFBTUMsWUFBWSxnQkFBZ0JDLFNBQ2pDQyxJQUFLLFdBQ0gsS0FYSixDQUFBLEdBQUl0QyxHQUFRSCxjQUVSc0MsR0FEU2xDLGVBQ0RILEVBQUUsZUFDVm1DLEVBQU9uQyxFQUFFLFNBQ1R5QyxFQUFhSixFQUFNbkMsT0FDTG1DLEdBQU1qQyxTQVN4QmlDLEVBQU1ULFNBQVMsZ0JBQWdCYyxLQUM5QkMsS0FBTXpDLEVBQVEsRUFBS3VDLEVBQWEsRUFBSyxHQUFL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c0NvbnRlbnQiOlsidmFyIHVzZXJLZXk7XG52YXIgdXNlck9iajtcblxuZnVuY3Rpb24gd2luZG93V2lkdGgoKSB7XG5cdHJldHVybiAkKHdpbmRvdykud2lkdGgoKTtcbn1cblxuZnVuY3Rpb24gd2luZG93SGVpZ2h0KCkge1xuXHRyZXR1cm4gJCh3aW5kb3cpLmhlaWdodCgpO1xufVxuXG5mdW5jdGlvbiBsb2FkRGF0YShrZXkpIHtcblx0JC5hamF4KHtcblx0XHR1cmw6ICd1c2Vycy9sb2dpbicsXG5cdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0ZGF0YToge1xuXHRcdFx0a2V5OiBrZXlcblx0XHR9LFxuXHRcdGRhdGFUeXBlOiAnanNvbicsXG5cdFx0c3VjY2VzczogZnVuY3Rpb24gKHVzZXIpIHtcblx0XHRcdHVzZXJPYmogPSB1c2VyO1xuXHRcdFx0dXNlci50b2Rvcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGkpIHtcblx0XHRcdFx0dmFyIHRvZG8gPSB2YWwuaXRlbTtcblx0XHRcdFx0dmFyIGNvbXBsZXRlID0gdmFsLnN0YXR1cztcblx0XHRcdFx0dmFyIGljb24gPSBjb21wbGV0ZSA/ICdmYSBmYS1jaGVjay1jaXJjbGUtbycgOiAnZmEgZmEtY2lyY2xlLW8nO1xuXHRcdFx0XHR2YXIgY2hlY2tlZCA9IGNvbXBsZXRlID8gJ2NoZWNrZWQnIDogJyc7XG5cdFx0XHRcdCQoJyN0b2RvLWxpc3QnKS5hcHBlbmQoXG5cdFx0XHRcdFx0JzxsaSBjbGFzcz1cInRvZG8gJyArIGNvbXBsZXRlICsgJ1wiIHZhbHVlPVwiJyArIHRvZG8gKyAnXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiY2hlY2tcIiAnICsgY2hlY2tlZCArICc+PC9pbnB1dD48aSBjbGFzcz1cIicgKyBpY29uICsgJ1wiPjwvaT48aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cInJlbmFtZVwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIiB2YWx1ZT1cIicgKyB0b2RvICsgJ1wiPjwvaW5wdXQ+PHNwYW4gY2xhc3M9XCJuYW1lXCI+JyArIHRvZG8gKyAnPC9zcGFuPjxpIGNsYXNzPVwiZmEgZmEtdHJhc2gtb1wiPjwvaT48L2xpPidcblx0XHRcdFx0KTtcblx0XHRcdH0pO1xuXHRcdFx0JCgnI2RhcmstbW9kZScpLmF0dHIoJ3ZhbHVlJywgdXNlci5kYXJrbW9kZSk7XG5cdFx0XHRpZiAodXNlci5kYXJrbW9kZSA9PT0gJ29uJykge1xuXHRcdFx0XHQkKCcjZGFyay1tb2RlJykuYWRkQ2xhc3MoJ2RhcmsnKTtcblx0XHRcdFx0JCgnYm9keScpLmFkZENsYXNzKCdkYXJrLW1vZGUnKVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uIChyZXN1bHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKHJlc3VsdCk7XG5cdFx0fVxuXHR9KTtcbn1cblxuXG5mdW5jdGlvbiBrZXlNb2RhbCgpIHtcblx0dmFyIHdpZHRoID0gd2luZG93V2lkdGgoKTtcblx0dmFyIGhlaWdodCA9IHdpbmRvd0hlaWdodCgpO1xuXHR2YXIgbW9kYWwgPSAkKCcja2V5LW1vZGFsJyk7XG5cdHZhciBtYXNrID0gJCgnI21hc2snKTtcblx0dmFyIG1vZGFsV2lkdGggPSBtb2RhbC53aWR0aCgpO1xuXHR2YXIgbW9kYWxIZWlnaHQgPSBtb2RhbC5oZWlnaHQoKTtcblxuXHRmdW5jdGlvbiByZW1vdmVNb2RhbCgpIHtcblx0XHRtYXNrLmZhZGVPdXQoNTAwKTtcblx0XHRtb2RhbC5yZW1vdmVDbGFzcygnYWN0aXZlLW1vZGFsJykuYW5pbWF0ZSh7XG5cdFx0XHR0b3A6ICctMTAwMHB4J1xuXHRcdH0sIDUwMCk7XG5cdH1cblxuXHRtb2RhbC5hZGRDbGFzcygnYWN0aXZlLW1vZGFsJykuY3NzKHtcblx0XHRsZWZ0OiB3aWR0aCAvIDIgLSAobW9kYWxXaWR0aCAvIDIpIC0gMTAgKyAncHgnXG5cdH0pO1xuXHRtb2RhbC5hbmltYXRlKHtcblx0XHR0b3A6ICcxMCUnXG5cdH0sIDUwMCk7XG5cdGlmICh3aW5kb3dXaWR0aCgpIDwgNzY4KSB7XG5cdFx0bW9kYWwuY3NzKHtcblx0XHRcdHdpZHRoOiB3aWR0aCArICdweCdcblx0XHR9KTtcblx0fVxuXG5cdChmdW5jdGlvbiAoKSB7XG5cdFx0JCgnI3RpcHMtYnV0dG9uJykuY2xpY2soZnVuY3Rpb24gKCkge1xuXHRcdFx0JCgnLmZpbmUtcHJpbnQnKS5zbGlkZVRvZ2dsZSgyNTApO1xuXHRcdH0pXG5cdH0pKCk7XG5cblx0JCgnI2tleScpLmZvY3VzKCk7XG5cdG1hc2suY2xpY2soZnVuY3Rpb24gKCkge1xuXHRcdHJlbW92ZU1vZGFsKCk7XG5cdFx0JCgnI2NyZWF0ZS10b2RvJykuZm9jdXMoKTtcblx0fSk7XG5cblx0JCgnI2tleScpLmtleWRvd24oZnVuY3Rpb24gKCkge1xuXHRcdHZhciBrZXkgPSBldmVudC53aGljaDtcblx0XHRpZiAoa2V5ID09PSAxMykge1xuXHRcdFx0dXNlcktleSA9ICQodGhpcykudmFsKCk7XG5cdFx0XHRyZW1vdmVNb2RhbCgpO1xuXHRcdFx0aWYgKHVzZXJLZXkpIGxvYWREYXRhKHVzZXJLZXkpO1xuXHRcdFx0JCgnI2NyZWF0ZS10b2RvJykuZm9jdXMoKTtcblx0XHR9XG5cdH0pXG59XG5cbmZ1bmN0aW9uIHNvcnRhYmxlKCkge1xuXHR2YXIgbGlzdCA9ICQoJyN0b2RvLWxpc3QnKTtcblx0bGlzdC5zb3J0YWJsZSh7XG5cdFx0YXhpczogXCJ5XCIsXG5cdFx0aXRlbXM6IFwiPiBsaTpub3QoLmNvbXBsZXRlKVwiXG5cdH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUb2RvKCkge1xuXHQkKCcjY3JlYXRlLXRvZG8nKS5rZXlkb3duKGZ1bmN0aW9uICgpIHtcblx0XHR2YXIga2V5ID0gZXZlbnQud2hpY2g7XG5cdFx0aWYgKGtleSA9PT0gMTMpIHtcblx0XHRcdHZhciB0b2RvID0gJCh0aGlzKS52YWwoKTtcblx0XHRcdCQoJyN0b2RvLWxpc3QnKS5wcmVwZW5kKFxuXHRcdFx0XHQnPGxpIGNsYXNzPVwidG9kb1wiIHZhbHVlPVwiJyArIHRvZG8gKyAnXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiY2hlY2tcIj48L2lucHV0PjxpIGNsYXNzPVwiZmEgZmEtY2lyY2xlLW9cIj48L2k+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJyZW5hbWVcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCIgdmFsdWU9XCInICsgdG9kbyArICdcIj48L2lucHV0PjxzcGFuIGNsYXNzPVwibmFtZVwiPicgKyB0b2RvICsgJzwvc3Bhbj48aSBjbGFzcz1cImZhIGZhLXRyYXNoLW9cIj48L2k+PC9saT4nXG5cdFx0XHQpO1xuXHRcdFx0JCh0aGlzKS52YWwoJycpO1xuXHRcdH1cblx0fSlcbn1cblxuZnVuY3Rpb24gY29tcGxldGVJdGVtKCkge1xuXHQkKCcjdG9kby1saXN0Jykub24oJ2NsaWNrJywgJy5mYS1jaXJjbGUtbycsIGZ1bmN0aW9uICgpIHtcblx0XHQkKHRoaXMpLnNpYmxpbmdzKCcuY2hlY2snKS5jbGljaygpO1xuXHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2ZhLWNpcmNsZS1vJykuYWRkQ2xhc3MoJ2ZhLWNoZWNrLWNpcmNsZS1vJyk7XG5cdH0pO1xuXHQkKCcjdG9kby1saXN0Jykub24oJ2NsaWNrJywgJy5mYS1jaGVjay1jaXJjbGUtbycsIGZ1bmN0aW9uICgpIHtcblx0XHQkKHRoaXMpLnNpYmxpbmdzKCcuY2hlY2snKS5jbGljaygpO1xuXHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2ZhLWNoZWNrLWNpcmNsZS1vJykuYWRkQ2xhc3MoJ2ZhLWNpcmNsZS1vJyk7XG5cdH0pO1xuXHQkKCcjdG9kby1saXN0Jykub24oJ2NsaWNrJywgJy5jaGVjaycsIGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgY2hlY2tlZCA9ICQodGhpcykucHJvcCgnY2hlY2tlZCcpO1xuXHRcdHZhciBpdGVtID0gJCh0aGlzKS5wYXJlbnQoKTtcblx0XHR2YXIgbGlzdCA9ICQodGhpcykucGFyZW50cygnI3RvZG8tbGlzdCcpO1xuXHRcdHZhciBmaXJzdENvbXBsZXRlID0gJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncygnLmNvbXBsZXRlJykuZmlyc3QoKTtcblx0XHRpZiAoY2hlY2tlZCkge1xuXHRcdFx0aXRlbS5hZGRDbGFzcygnY29tcGxldGUnKTtcblx0XHRcdGZpcnN0Q29tcGxldGUubGVuZ3RoID4gMCA/IGZpcnN0Q29tcGxldGUuYmVmb3JlKGl0ZW0pIDogbGlzdC5hcHBlbmQoaXRlbSk7XG5cdFx0XHRsaXN0LnNvcnRhYmxlKCdkZXN0cm95Jyk7XG5cdFx0XHRzb3J0YWJsZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpdGVtLnJlbW92ZUNsYXNzKCdjb21wbGV0ZScpO1xuXHRcdFx0Zmlyc3RDb21wbGV0ZS5sZW5ndGggPiAwID8gZmlyc3RDb21wbGV0ZS5iZWZvcmUoaXRlbSkgOiBsaXN0LmFwcGVuZChpdGVtKTtcblx0XHRcdGxpc3Quc29ydGFibGUoJ2Rlc3Ryb3knKTtcblx0XHRcdHNvcnRhYmxlKCk7XG5cdFx0fVxuXHR9KTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlSXRlbSgpIHtcblx0JCgnI3RvZG8tbGlzdCcpLm9uKCdjbGljaycsICcuZmEtdHJhc2gtbycsIGZ1bmN0aW9uICgpIHtcblx0XHQkKHRoaXMpLnBhcmVudHMoJ2xpJykudG9nZ2xlKCdzbGlkZScsIDUwMCwgZnVuY3Rpb24gKCkge1xuXHRcdFx0JCh0aGlzKS5yZW1vdmUoKTtcblx0XHR9KTtcblx0fSlcbn1cblxuZnVuY3Rpb24gcmVuYW1lSXRlbSgpIHtcblx0JCgnI3RvZG8tbGlzdCcpLm9uKCdkYmxjbGljaycsICcubmFtZScsIGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgbmFtZSA9ICQodGhpcykudGV4dCgpO1xuXHRcdCQodGhpcykuaGlkZSgpO1xuXHRcdCQodGhpcykuc2libGluZ3MoJy5yZW5hbWUnKS5zaG93KCkuc2VsZWN0KCk7XG5cdH0pO1xuXG5cdCQoJyN0b2RvLWxpc3QnKS5vbigna2V5ZG93bicsICcucmVuYW1lJywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciBrZXkgPSBldmVudC53aGljaDtcblx0XHRpZiAoa2V5ID09PSAxMykge1xuXHRcdFx0dmFyIG5ld05hbWUgPSAkKHRoaXMpLnZhbCgpO1xuXHRcdFx0JCh0aGlzKS5zaWJsaW5ncygnLm5hbWUnKS5zaG93KCkudGV4dChuZXdOYW1lKTtcblx0XHRcdCQodGhpcykuaGlkZSgpLmF0dHIoJ3ZhbHVlJywgbmV3TmFtZSk7XG5cdFx0XHQkKHRoaXMpLnBhcmVudHMoJy50b2RvJykuYXR0cigndmFsdWUnLCBuZXdOYW1lKTtcblxuXHRcdH1cblx0fSk7XG59XG5cbmZ1bmN0aW9uIHdyaXRlRGF0YSgpIHtcblx0ZnVuY3Rpb24gY3JlYXRlT2JqKCkge1xuXHRcdHZhciBsaUFyciA9ICQoJyN0b2RvLWxpc3QgbGknKTtcblx0XHR2YXIgdG9kb0FyciA9IFtdO1xuXHRcdHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdGxpQXJyLmVhY2goZnVuY3Rpb24gKGksIHZhbCkge1xuXHRcdFx0dmFyIHRvZG9UZXh0ID0gJCh0aGlzKS5hdHRyKCd2YWx1ZScpO1xuXHRcdFx0dmFyIHRvZG9PYmogPSB7fTtcblx0XHRcdHRvZG9PYmouaXRlbSA9IHRvZG9UZXh0O1xuXHRcdFx0dG9kb09iai5zdGF0dXMgPSAkKHRoaXMpLmhhc0NsYXNzKCdjb21wbGV0ZScpID8gJ2NvbXBsZXRlJyA6ICcnO1xuXHRcdFx0dG9kb0Fyci5wdXNoKHRvZG9PYmopO1xuXHRcdH0pXG5cdFx0dXNlck9iai50b2RvcyA9IHRvZG9BcnI7XG5cdFx0dXNlck9iai5kYXJrbW9kZSA9ICQoJyNkYXJrLW1vZGUnKS5hdHRyKCd2YWx1ZScpO1xuXHRcdHVzZXJPYmouZGF0ZU1vZGlmaWVkID0gbm93LnRvSVNPU3RyaW5nKCk7XG5cdFx0cmV0dXJuIHVzZXJPYmo7XG5cdH1cblxuXHQvL2Rlc2t0b3Agd3JpdGUgdG8gZGJcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0dmFyIG9iaiA9ICh1c2VyS2V5Lmxlbmd0aCA+IDApID8gY3JlYXRlT2JqKCkgOiBudWxsO1xuXHRcdGlmICh1c2VyS2V5KSB7XG5cdFx0XHQkLnBvc3QoXCIvdXNlcnMvd3JpdGVcIiwge1xuXHRcdFx0XHRqc29uOiBKU09OLnN0cmluZ2lmeShvYmopLFxuXHRcdFx0fSwgZnVuY3Rpb24gKHJlc3VsdCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXN1bHQpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblxuXHQvL21vYmlsZSBTYWZhcmkgd3JpdGUgdG8gZGIgKGRvZXNuJ3Qgc3VwcG9ydCB1bmxvYWQpXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwYWdlaGlkZScsIGZ1bmN0aW9uIChlKSB7XG5cdFx0dmFyIG9iaiA9ICh1c2VyS2V5Lmxlbmd0aCA+IDApID8gY3JlYXRlT2JqKCkgOiBudWxsO1xuXHRcdGlmICh1c2VyS2V5KSB7XG5cdFx0XHQkLnBvc3QoXCIvdXNlcnMvd3JpdGVcIiwge1xuXHRcdFx0XHRqc29uOiBKU09OLnN0cmluZ2lmeShvYmopLFxuXHRcdFx0fSwgZnVuY3Rpb24gKHJlc3VsdCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXN1bHQpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn1cblxuZnVuY3Rpb24gZGFya01vZGUoKSB7XG5cdCQoJyNkYXJrLW1vZGUnKS5jbGljayhmdW5jdGlvbiAoKSB7XG5cdFx0JCh0aGlzKS50b2dnbGVDbGFzcygnZGFyaycpO1xuXHRcdCQoJ2JvZHknKS50b2dnbGVDbGFzcygnZGFyay1tb2RlJyk7XG5cdFx0dmFyIHZhbHVlID0gJCh0aGlzKS5oYXNDbGFzcygnZGFyaycpID8gJ29uJyA6ICdvZmYnXG5cdFx0JCh0aGlzKS5hdHRyKCd2YWx1ZScsIHZhbHVlKTtcblx0fSk7XG59XG5cbiQoa2V5TW9kYWwpO1xuJChzb3J0YWJsZSk7XG4kKGNyZWF0ZVRvZG8pO1xuJChjb21wbGV0ZUl0ZW0pO1xuJChkZWxldGVJdGVtKTtcbiQocmVuYW1lSXRlbSk7XG4kKHdyaXRlRGF0YSk7XG4kKGRhcmtNb2RlKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=